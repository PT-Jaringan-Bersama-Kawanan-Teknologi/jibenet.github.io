import{d as A,K as O,e as P,g as B,b as p,f as F,h as H,j as b,k as $,l as U,m as Y}from"./index-DqRlgtYI.js";const D=new WeakMap,I=(e,s,t,o=0,r=!1)=>{D.has(e)!==t&&(t?G(e,s,o,r):W(e,s))},q=e=>e===e.getRootNode().activeElement,G=(e,s,t,o=!1)=>{const r=s.parentNode,n=s.cloneNode(!1);n.classList.add("cloned-input"),n.tabIndex=-1,o&&(n.disabled=!0),r.appendChild(n),D.set(e,n);const a=e.ownerDocument.dir==="rtl"?9999:-9999;e.style.pointerEvents="none",s.style.transform="translate3d(".concat(a,"px,").concat(t,"px,0) scale(0)")},W=(e,s)=>{const t=D.get(e);t&&(D.delete(e),t.remove()),e.style.pointerEvents="",s.style.transform=""},N=50,j=(e,s,t)=>{if(!t||!s)return()=>{};const o=a=>{q(s)&&I(e,s,a)},r=()=>I(e,s,!1),n=()=>o(!0),c=()=>o(!1);return P(t,"ionScrollStart",n),P(t,"ionScrollEnd",c),s.addEventListener("blur",r),()=>{B(t,"ionScrollStart",n),B(t,"ionScrollEnd",c),s.removeEventListener("blur",r)}},T="input, textarea, [no-blur], [contenteditable]",z=()=>{let e=!0,s=!1;const t=document,o=()=>{s=!0},r=()=>{e=!0},n=c=>{if(s){s=!1;return}const a=t.activeElement;if(!a||a.matches(T))return;const f=c.target;f!==a&&(f.matches(T)||f.closest(T)||(e=!1,setTimeout(()=>{e||a.blur()},50)))};return P(t,"ionScrollStart",o),t.addEventListener("focusin",r,!0),t.addEventListener("touchend",n,!1),()=>{B(t,"ionScrollStart",o,!0),t.removeEventListener("focusin",r,!0),t.removeEventListener("touchend",n,!1)}},J=.3,Q=(e,s,t,o)=>{var r;const n=(r=e.closest("ion-item,[ion-item]"))!==null&&r!==void 0?r:e;return V(n.getBoundingClientRect(),s.getBoundingClientRect(),t,o)},V=(e,s,t,o)=>{const r=e.top,n=e.bottom,c=s.top,a=Math.min(s.bottom,o-t),f=c+15,u=a-N-n,d=f-r,S=Math.round(u<0?-u:d>0?-d:0),v=Math.min(S,r-c),i=Math.abs(v)/J,h=Math.min(400,Math.max(150,i));return{scrollAmount:v,scrollDuration:h,scrollPadding:t,inputSafeY:-(r-f)+4}},R="$ionPaddingTimer",M=(e,s,t)=>{const o=e[R];o&&clearTimeout(o),s>0?e.style.setProperty("--keyboard-offset","".concat(s,"px")):e[R]=setTimeout(()=>{e.style.setProperty("--keyboard-offset","0px"),t&&t()},120)},_=(e,s,t)=>{const o=()=>{s&&M(s,0,t)};e.addEventListener("focusout",o,{once:!0})};let g=0;const K="data-ionic-skip-scroll-assist",X=(e,s,t,o,r,n,c,a=!1)=>{const f=n&&(c===void 0||c.mode===H.None);let l=!1;const u=b!==void 0?b.innerHeight:0,d=y=>{if(l===!1){l=!0;return}k(e,s,t,o,y.detail.keyboardHeight,f,a,u,!1)},S=()=>{l=!1,b===null||b===void 0||b.removeEventListener("ionKeyboardDidShow",d),e.removeEventListener("focusout",S)},v=async()=>{if(s.hasAttribute(K)){s.removeAttribute(K);return}k(e,s,t,o,r,f,a,u),b===null||b===void 0||b.addEventListener("ionKeyboardDidShow",d),e.addEventListener("focusout",S)};return e.addEventListener("focusin",v),()=>{e.removeEventListener("focusin",v),b===null||b===void 0||b.removeEventListener("ionKeyboardDidShow",d),e.removeEventListener("focusout",S)}},C=e=>{var s;if(document.activeElement===e)return;const t=e.getAttribute("id"),o=e.closest('label[for="'.concat(t,'"]')),r=(s=document.activeElement)===null||s===void 0?void 0:s.closest('label[for="'.concat(t,'"]'));o!==null&&o===r||(e.setAttribute(K,"true"),e.focus())},k=async(e,s,t,o,r,n,c=!1,a=0,f=!0)=>{if(!t&&!o)return;const l=Q(e,t||o,r,a);if(t&&Math.abs(l.scrollAmount)<4){C(s),n&&t!==null&&(M(t,g),_(s,t,()=>g=0));return}if(I(e,s,!0,l.inputSafeY,c),C(s),$(()=>e.click()),n&&t&&(g=l.scrollPadding,M(t,g)),typeof window<"u"){let u;const d=async()=>{u!==void 0&&clearTimeout(u),window.removeEventListener("ionKeyboardDidShow",S),window.removeEventListener("ionKeyboardDidShow",d),t&&await Y(t,0,l.scrollAmount,l.scrollDuration),I(e,s,!1,l.inputSafeY),C(s),n&&_(s,t,()=>g=0)},S=()=>{window.removeEventListener("ionKeyboardDidShow",S),window.addEventListener("ionKeyboardDidShow",d)};if(t){const v=await U(t),y=v.scrollHeight-v.clientHeight;if(f&&l.scrollAmount>y-v.scrollTop){s.type==="password"?(l.scrollAmount+=N,window.addEventListener("ionKeyboardDidShow",S)):window.addEventListener("ionKeyboardDidShow",d),u=setTimeout(d,1e3);return}}d()}},Z=!0,te=async(e,s)=>{if(A===void 0)return;const t=s==="ios",o=s==="android",r=e.getNumber("keyboardHeight",290),n=e.getBoolean("scrollAssist",!0),c=e.getBoolean("hideCaretOnScroll",t),a=e.getBoolean("inputBlurring",!1),f=e.getBoolean("scrollPadding",!0),l=Array.from(A.querySelectorAll("ion-input, ion-textarea")),u=new WeakMap,d=new WeakMap,S=await O.getResizeMode(),v=async i=>{await new Promise(w=>p(i,w));const h=i.shadowRoot||i,m=h.querySelector("input")||h.querySelector("textarea"),L=F(i),x=L?null:i.closest("ion-footer");if(!m)return;if(L&&c&&!u.has(i)){const w=j(i,m,L);u.set(i,w)}if(!(m.type==="date"||m.type==="datetime-local")&&(L||x)&&n&&!d.has(i)){const w=X(i,m,L,x,r,f,S,o);d.set(i,w)}},y=i=>{if(c){const h=u.get(i);h&&h(),u.delete(i)}if(n){const h=d.get(i);h&&h(),d.delete(i)}};a&&Z&&z();for(const i of l)v(i);A.addEventListener("ionInputDidLoad",i=>{v(i.detail)}),A.addEventListener("ionInputDidUnload",i=>{y(i.detail)})};export{te as startInputShims};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXQtc2hpbXMtQ2hLNDMxdlIuanMiLCJzb3VyY2VzIjpbIi4uLy4uL25vZGVfbW9kdWxlcy9AaW9uaWMvY29yZS9jb21wb25lbnRzL2lucHV0LXNoaW1zLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogKEMpIElvbmljIGh0dHA6Ly9pb25pY2ZyYW1ld29yay5jb20gLSBNSVQgTGljZW5zZVxuICovXG5pbXBvcnQgeyB3IGFzIHdpbiwgZCBhcyBkb2MgfSBmcm9tICcuL2luZGV4OS5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldFNjcm9sbEVsZW1lbnQsIGMgYXMgc2Nyb2xsQnlQb2ludCwgYSBhcyBmaW5kQ2xvc2VzdElvbkNvbnRlbnQgfSBmcm9tICcuL2luZGV4OC5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEV2ZW50TGlzdGVuZXIsIGIgYXMgcmVtb3ZlRXZlbnRMaXN0ZW5lciwgciBhcyByYWYsIGMgYXMgY29tcG9uZW50T25SZWFkeSB9IGZyb20gJy4vaGVscGVycy5qcyc7XG5pbXBvcnQgeyBhIGFzIEtleWJvYXJkUmVzaXplLCBLIGFzIEtleWJvYXJkIH0gZnJvbSAnLi9rZXlib2FyZDIuanMnO1xuXG5jb25zdCBjbG9uZU1hcCA9IG5ldyBXZWFrTWFwKCk7XG5jb25zdCByZWxvY2F0ZUlucHV0ID0gKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBzaG91bGRSZWxvY2F0ZSwgaW5wdXRSZWxhdGl2ZVkgPSAwLCBkaXNhYmxlZENsb25lZElucHV0ID0gZmFsc2UpID0+IHtcbiAgICBpZiAoY2xvbmVNYXAuaGFzKGNvbXBvbmVudEVsKSA9PT0gc2hvdWxkUmVsb2NhdGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoc2hvdWxkUmVsb2NhdGUpIHtcbiAgICAgICAgYWRkQ2xvbmUoY29tcG9uZW50RWwsIGlucHV0RWwsIGlucHV0UmVsYXRpdmVZLCBkaXNhYmxlZENsb25lZElucHV0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJlbW92ZUNsb25lKGNvbXBvbmVudEVsLCBpbnB1dEVsKTtcbiAgICB9XG59O1xuY29uc3QgaXNGb2N1c2VkID0gKGlucHV0KSA9PiB7XG4gICAgLyoqXG4gICAgICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL05vZGUvZ2V0Um9vdE5vZGVcbiAgICAgKiBDYWxsaW5nIGdldFJvb3ROb2RlIG9uIGFuIGVsZW1lbnQgaW4gc3RhbmRhcmQgd2ViIHBhZ2Ugd2lsbCByZXR1cm4gSFRNTERvY3VtZW50LlxuICAgICAqIENhbGxpbmcgZ2V0Um9vdE5vZGUgb24gYW4gZWxlbWVudCBpbnNpZGUgb2YgdGhlIFNoYWRvdyBET00gd2lsbCByZXR1cm4gdGhlIGFzc29jaWF0ZWQgU2hhZG93Um9vdC5cbiAgICAgKiBDYWxsaW5nIGdldFJvb3ROb2RlIG9uIGFuIGVsZW1lbnQgdGhhdCBpcyBub3QgYXR0YWNoZWQgdG8gYSBkb2N1bWVudC9zaGFkb3cgdHJlZSB3aWxsIHJldHVyblxuICAgICAqIHRoZSByb290IG9mIHRoZSBET00gdHJlZSBpdCBiZWxvbmdzIHRvLlxuICAgICAqIGlzRm9jdXNlZCBpcyB1c2VkIGZvciB0aGUgaGlkZS1jYXJldCB1dGlsaXR5IHdoaWNoIG9ubHkgY29uc2lkZXJzIGlucHV0L3RleHRhcmVhIGVsZW1lbnRzXG4gICAgICogdGhhdCBhcmUgcHJlc2VudCBpbiB0aGUgRE9NLCBzbyB3ZSBkb24ndCBzZXQgdHlwZXMgZm9yIHRoYXQgZmluYWwgY2FzZSBzaW5jZSBpdCBkb2VzIG5vdCBhcHBseS5cbiAgICAgKi9cbiAgICByZXR1cm4gaW5wdXQgPT09IGlucHV0LmdldFJvb3ROb2RlKCkuYWN0aXZlRWxlbWVudDtcbn07XG5jb25zdCBhZGRDbG9uZSA9IChjb21wb25lbnRFbCwgaW5wdXRFbCwgaW5wdXRSZWxhdGl2ZVksIGRpc2FibGVkQ2xvbmVkSW5wdXQgPSBmYWxzZSkgPT4ge1xuICAgIC8vIHRoaXMgYWxsb3dzIGZvciB0aGUgYWN0dWFsIGlucHV0IHRvIHJlY2VpdmUgdGhlIGZvY3VzIGZyb21cbiAgICAvLyB0aGUgdXNlcidzIHRvdWNoIGV2ZW50LCBidXQgYmVmb3JlIGl0IHJlY2VpdmVzIGZvY3VzLCBpdFxuICAgIC8vIG1vdmVzIHRoZSBhY3R1YWwgaW5wdXQgdG8gYSBsb2NhdGlvbiB0aGF0IHdpbGwgbm90IHNjcmV3XG4gICAgLy8gdXAgdGhlIGFwcCdzIGxheW91dCwgYW5kIGRvZXMgbm90IGFsbG93IHRoZSBuYXRpdmUgYnJvd3NlclxuICAgIC8vIHRvIGF0dGVtcHQgdG8gc2Nyb2xsIHRoZSBpbnB1dCBpbnRvIHBsYWNlIChtZXNzaW5nIHVwIGhlYWRlcnMvZm9vdGVycylcbiAgICAvLyB0aGUgY2xvbmVkIGlucHV0IGZpbGxzIHRoZSBhcmVhIG9mIHdoZXJlIG5hdGl2ZSBpbnB1dCBzaG91bGQgYmVcbiAgICAvLyB3aGlsZSB0aGUgbmF0aXZlIGlucHV0IGZha2VzIG91dCB0aGUgYnJvd3NlciBieSByZWxvY2F0aW5nIGl0c2VsZlxuICAgIC8vIGJlZm9yZSBpdCByZWNlaXZlcyB0aGUgYWN0dWFsIGZvY3VzIGV2ZW50XG4gICAgLy8gV2UgaGlkZSB0aGUgZm9jdXNlZCBpbnB1dCAod2l0aCB0aGUgdmlzaWJsZSBjYXJldCkgaW52aXNpYmxlIGJ5IG1ha2luZyBpdCBzY2FsZSgwKSxcbiAgICBjb25zdCBwYXJlbnRFbCA9IGlucHV0RWwucGFyZW50Tm9kZTtcbiAgICAvLyBET00gV1JJVEVTXG4gICAgY29uc3QgY2xvbmVkRWwgPSBpbnB1dEVsLmNsb25lTm9kZShmYWxzZSk7XG4gICAgY2xvbmVkRWwuY2xhc3NMaXN0LmFkZCgnY2xvbmVkLWlucHV0Jyk7XG4gICAgY2xvbmVkRWwudGFiSW5kZXggPSAtMTtcbiAgICAvKipcbiAgICAgKiBNYWtpbmcgdGhlIGNsb25lZCBpbnB1dCBkaXNhYmxlZCBwcmV2ZW50c1xuICAgICAqIENocm9tZSBmb3IgQW5kcm9pZCBmcm9tIHN0aWxsIHNjcm9sbGluZ1xuICAgICAqIHRoZSBlbnRpcmUgcGFnZSBzaW5jZSB0aGlzIGNsb25lZCBpbnB1dFxuICAgICAqIHdpbGwgYnJpZWZseSBiZSBoaWRkZW4gYnkgdGhlIGtleWJvYXJkXG4gICAgICogZXZlbiB0aG91Z2ggaXQgaXMgbm90IGZvY3VzZWQuXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIG5vdCBuZWVkZWQgb24gaU9TLiBXaGlsZSB0aGlzXG4gICAgICogZG9lcyBub3QgY2F1c2UgZnVuY3Rpb25hbCBpc3N1ZXMgb24gaU9TLFxuICAgICAqIHRoZSBpbnB1dCBzdGlsbCBhcHBlYXJzIHNsaWdodGx5IGRpbW1lZCBldmVuXG4gICAgICogaWYgd2Ugc2V0IG9wYWNpdHk6IDEuXG4gICAgICovXG4gICAgaWYgKGRpc2FibGVkQ2xvbmVkSW5wdXQpIHtcbiAgICAgICAgY2xvbmVkRWwuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgICBwYXJlbnRFbC5hcHBlbmRDaGlsZChjbG9uZWRFbCk7XG4gICAgY2xvbmVNYXAuc2V0KGNvbXBvbmVudEVsLCBjbG9uZWRFbCk7XG4gICAgY29uc3QgZG9jID0gY29tcG9uZW50RWwub3duZXJEb2N1bWVudDtcbiAgICBjb25zdCB0eCA9IGRvYy5kaXIgPT09ICdydGwnID8gOTk5OSA6IC05OTk5O1xuICAgIGNvbXBvbmVudEVsLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnbm9uZSc7XG4gICAgaW5wdXRFbC5zdHlsZS50cmFuc2Zvcm0gPSBgdHJhbnNsYXRlM2QoJHt0eH1weCwke2lucHV0UmVsYXRpdmVZfXB4LDApIHNjYWxlKDApYDtcbn07XG5jb25zdCByZW1vdmVDbG9uZSA9IChjb21wb25lbnRFbCwgaW5wdXRFbCkgPT4ge1xuICAgIGNvbnN0IGNsb25lID0gY2xvbmVNYXAuZ2V0KGNvbXBvbmVudEVsKTtcbiAgICBpZiAoY2xvbmUpIHtcbiAgICAgICAgY2xvbmVNYXAuZGVsZXRlKGNvbXBvbmVudEVsKTtcbiAgICAgICAgY2xvbmUucmVtb3ZlKCk7XG4gICAgfVxuICAgIGNvbXBvbmVudEVsLnN0eWxlLnBvaW50ZXJFdmVudHMgPSAnJztcbiAgICBpbnB1dEVsLnN0eWxlLnRyYW5zZm9ybSA9ICcnO1xufTtcbi8qKlxuICogRmFjdG9yaW5nIGluIDUwcHggZ2l2ZXMgdXMgc29tZSByb29tXG4gKiBpbiBjYXNlIHRoZSBrZXlib2FyZCBzaG93cyBwYXNzd29yZC9hdXRvZmlsbCBiYXJzXG4gKiBhc3luY2hyb25vdXNseS5cbiAqL1xuY29uc3QgU0NST0xMX0FNT1VOVF9QQURESU5HID0gNTA7XG5cbmNvbnN0IGVuYWJsZUhpZGVDYXJldE9uU2Nyb2xsID0gKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBzY3JvbGxFbCkgPT4ge1xuICAgIGlmICghc2Nyb2xsRWwgfHwgIWlucHV0RWwpIHtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY29uc3Qgc2Nyb2xsSGlkZUNhcmV0ID0gKHNob3VsZEhpZGVDYXJldCkgPT4ge1xuICAgICAgICBpZiAoaXNGb2N1c2VkKGlucHV0RWwpKSB7XG4gICAgICAgICAgICByZWxvY2F0ZUlucHV0KGNvbXBvbmVudEVsLCBpbnB1dEVsLCBzaG91bGRIaWRlQ2FyZXQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBvbkJsdXIgPSAoKSA9PiByZWxvY2F0ZUlucHV0KGNvbXBvbmVudEVsLCBpbnB1dEVsLCBmYWxzZSk7XG4gICAgY29uc3QgaGlkZUNhcmV0ID0gKCkgPT4gc2Nyb2xsSGlkZUNhcmV0KHRydWUpO1xuICAgIGNvbnN0IHNob3dDYXJldCA9ICgpID0+IHNjcm9sbEhpZGVDYXJldChmYWxzZSk7XG4gICAgYWRkRXZlbnRMaXN0ZW5lcihzY3JvbGxFbCwgJ2lvblNjcm9sbFN0YXJ0JywgaGlkZUNhcmV0KTtcbiAgICBhZGRFdmVudExpc3RlbmVyKHNjcm9sbEVsLCAnaW9uU2Nyb2xsRW5kJywgc2hvd0NhcmV0KTtcbiAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBvbkJsdXIpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoc2Nyb2xsRWwsICdpb25TY3JvbGxTdGFydCcsIGhpZGVDYXJldCk7XG4gICAgICAgIHJlbW92ZUV2ZW50TGlzdGVuZXIoc2Nyb2xsRWwsICdpb25TY3JvbGxFbmQnLCBzaG93Q2FyZXQpO1xuICAgICAgICBpbnB1dEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCBvbkJsdXIpO1xuICAgIH07XG59O1xuXG5jb25zdCBTS0lQX1NFTEVDVE9SID0gJ2lucHV0LCB0ZXh0YXJlYSwgW25vLWJsdXJdLCBbY29udGVudGVkaXRhYmxlXSc7XG5jb25zdCBlbmFibGVJbnB1dEJsdXJyaW5nID0gKCkgPT4ge1xuICAgIGxldCBmb2N1c2VkID0gdHJ1ZTtcbiAgICBsZXQgZGlkU2Nyb2xsID0gZmFsc2U7XG4gICAgY29uc3QgZG9jID0gZG9jdW1lbnQ7XG4gICAgY29uc3Qgb25TY3JvbGwgPSAoKSA9PiB7XG4gICAgICAgIGRpZFNjcm9sbCA9IHRydWU7XG4gICAgfTtcbiAgICBjb25zdCBvbkZvY3VzaW4gPSAoKSA9PiB7XG4gICAgICAgIGZvY3VzZWQgPSB0cnVlO1xuICAgIH07XG4gICAgY29uc3Qgb25Ub3VjaGVuZCA9IChldikgPT4ge1xuICAgICAgICAvLyBpZiBhcHAgZGlkIHNjcm9sbCByZXR1cm4gZWFybHlcbiAgICAgICAgaWYgKGRpZFNjcm9sbCkge1xuICAgICAgICAgICAgZGlkU2Nyb2xsID0gZmFsc2U7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYWN0aXZlID0gZG9jLmFjdGl2ZUVsZW1lbnQ7XG4gICAgICAgIGlmICghYWN0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gb25seSBibHVyIGlmIHRoZSBhY3RpdmUgZWxlbWVudCBpcyBhIHRleHQtaW5wdXQgb3IgYSB0ZXh0YXJlYVxuICAgICAgICBpZiAoYWN0aXZlLm1hdGNoZXMoU0tJUF9TRUxFQ1RPUikpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICAvLyBpZiB0aGUgc2VsZWN0ZWQgdGFyZ2V0IGlzIHRoZSBhY3RpdmUgZWxlbWVudCwgZG8gbm90IGJsdXJcbiAgICAgICAgY29uc3QgdGFwcGVkID0gZXYudGFyZ2V0O1xuICAgICAgICBpZiAodGFwcGVkID09PSBhY3RpdmUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGFwcGVkLm1hdGNoZXMoU0tJUF9TRUxFQ1RPUikgfHwgdGFwcGVkLmNsb3Nlc3QoU0tJUF9TRUxFQ1RPUikpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBmb2N1c2VkID0gZmFsc2U7XG4gICAgICAgIC8vIFRPRE8gRlctMjc5NjogZmluZCBhIGJldHRlciB3YXksIHdoeSA1MG1zP1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmICghZm9jdXNlZCkge1xuICAgICAgICAgICAgICAgIGFjdGl2ZS5ibHVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIDUwKTtcbiAgICB9O1xuICAgIGFkZEV2ZW50TGlzdGVuZXIoZG9jLCAnaW9uU2Nyb2xsU3RhcnQnLCBvblNjcm9sbCk7XG4gICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBvbkZvY3VzaW4sIHRydWUpO1xuICAgIGRvYy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG9uVG91Y2hlbmQsIGZhbHNlKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICByZW1vdmVFdmVudExpc3RlbmVyKGRvYywgJ2lvblNjcm9sbFN0YXJ0Jywgb25TY3JvbGwsIHRydWUpO1xuICAgICAgICBkb2MucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIG9uRm9jdXNpbiwgdHJ1ZSk7XG4gICAgICAgIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIG9uVG91Y2hlbmQsIGZhbHNlKTtcbiAgICB9O1xufTtcblxuY29uc3QgU0NST0xMX0FTU0lTVF9TUEVFRCA9IDAuMztcbmNvbnN0IGdldFNjcm9sbERhdGEgPSAoY29tcG9uZW50RWwsIGNvbnRlbnRFbCwga2V5Ym9hcmRIZWlnaHQsIHBsYXRmb3JtSGVpZ2h0KSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IGl0ZW1FbCA9IChfYSA9IGNvbXBvbmVudEVsLmNsb3Nlc3QoJ2lvbi1pdGVtLFtpb24taXRlbV0nKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogY29tcG9uZW50RWw7XG4gICAgcmV0dXJuIGNhbGNTY3JvbGxEYXRhKGl0ZW1FbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwgY29udGVudEVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCBrZXlib2FyZEhlaWdodCwgcGxhdGZvcm1IZWlnaHQpO1xufTtcbmNvbnN0IGNhbGNTY3JvbGxEYXRhID0gKGlucHV0UmVjdCwgY29udGVudFJlY3QsIGtleWJvYXJkSGVpZ2h0LCBwbGF0Zm9ybUhlaWdodCkgPT4ge1xuICAgIC8vIGNvbXB1dGUgaW5wdXQncyBZIHZhbHVlcyByZWxhdGl2ZSB0byB0aGUgYm9keVxuICAgIGNvbnN0IGlucHV0VG9wID0gaW5wdXRSZWN0LnRvcDtcbiAgICBjb25zdCBpbnB1dEJvdHRvbSA9IGlucHV0UmVjdC5ib3R0b207XG4gICAgLy8gY29tcHV0ZSB2aXNpYmxlIGFyZWFcbiAgICBjb25zdCB2aXNpYmxlQXJlYVRvcCA9IGNvbnRlbnRSZWN0LnRvcDtcbiAgICBjb25zdCB2aXNpYmxlQXJlYUJvdHRvbSA9IE1hdGgubWluKGNvbnRlbnRSZWN0LmJvdHRvbSwgcGxhdGZvcm1IZWlnaHQgLSBrZXlib2FyZEhlaWdodCk7XG4gICAgLy8gY29tcHV0ZSBzYWZlIGFyZWFcbiAgICBjb25zdCBzYWZlQXJlYVRvcCA9IHZpc2libGVBcmVhVG9wICsgMTU7XG4gICAgY29uc3Qgc2FmZUFyZWFCb3R0b20gPSB2aXNpYmxlQXJlYUJvdHRvbSAtIFNDUk9MTF9BTU9VTlRfUEFERElORztcbiAgICAvLyBmaWd1cmUgb3V0IGlmIGVhY2ggZWRnZSBvZiB0aGUgaW5wdXQgaXMgd2l0aGluIHRoZSBzYWZlIGFyZWFcbiAgICBjb25zdCBkaXN0YW5jZVRvQm90dG9tID0gc2FmZUFyZWFCb3R0b20gLSBpbnB1dEJvdHRvbTtcbiAgICBjb25zdCBkaXN0YW5jZVRvVG9wID0gc2FmZUFyZWFUb3AgLSBpbnB1dFRvcDtcbiAgICAvLyBkZXNpcmVkU2Nyb2xsQW1vdW50IGlzIHRoZSBuZWdhdGVkIGRpc3RhbmNlIHRvIHRoZSBzYWZlIGFyZWEgYWNjb3JkaW5nIHRvIG91ciBjYWxjdWxhdGlvbnMuXG4gICAgY29uc3QgZGVzaXJlZFNjcm9sbEFtb3VudCA9IE1hdGgucm91bmQoZGlzdGFuY2VUb0JvdHRvbSA8IDAgPyAtZGlzdGFuY2VUb0JvdHRvbSA6IGRpc3RhbmNlVG9Ub3AgPiAwID8gLWRpc3RhbmNlVG9Ub3AgOiAwKTtcbiAgICAvLyBvdXIgY2FsY3VsYXRpb25zIG1ha2Ugc29tZSBhc3N1bXB0aW9ucyB0aGF0IGFyZW4ndCBhbHdheXMgdHJ1ZSwgbGlrZSB0aGUga2V5Ym9hcmQgYmVpbmcgY2xvc2VkIHdoZW4gYW4gaW5wdXRcbiAgICAvLyBnZXRzIGZvY3VzLCBzbyBtYWtlIHN1cmUgd2UgZG9uJ3Qgc2Nyb2xsIHRoZSBpbnB1dCBhYm92ZSB0aGUgdmlzaWJsZSBhcmVhXG4gICAgY29uc3Qgc2Nyb2xsQW1vdW50ID0gTWF0aC5taW4oZGVzaXJlZFNjcm9sbEFtb3VudCwgaW5wdXRUb3AgLSB2aXNpYmxlQXJlYVRvcCk7XG4gICAgY29uc3QgZGlzdGFuY2UgPSBNYXRoLmFicyhzY3JvbGxBbW91bnQpO1xuICAgIGNvbnN0IGR1cmF0aW9uID0gZGlzdGFuY2UgLyBTQ1JPTExfQVNTSVNUX1NQRUVEO1xuICAgIGNvbnN0IHNjcm9sbER1cmF0aW9uID0gTWF0aC5taW4oNDAwLCBNYXRoLm1heCgxNTAsIGR1cmF0aW9uKSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2Nyb2xsQW1vdW50LFxuICAgICAgICBzY3JvbGxEdXJhdGlvbixcbiAgICAgICAgc2Nyb2xsUGFkZGluZzoga2V5Ym9hcmRIZWlnaHQsXG4gICAgICAgIGlucHV0U2FmZVk6IC0oaW5wdXRUb3AgLSBzYWZlQXJlYVRvcCkgKyA0LFxuICAgIH07XG59O1xuXG5jb25zdCBQQURESU5HX1RJTUVSX0tFWSA9ICckaW9uUGFkZGluZ1RpbWVyJztcbi8qKlxuICogU2Nyb2xsIHBhZGRpbmcgYWRkcyBhZGRpdGlvbmFsIHBhZGRpbmcgdG8gdGhlIGJvdHRvbVxuICogb2YgaW9uLWNvbnRlbnQgc28gdGhhdCB0aGVyZSBpcyBlbm91Z2ggc2Nyb2xsIHNwYWNlXG4gKiBmb3IgYW4gaW5wdXQgdG8gYmUgc2Nyb2xsZWQgYWJvdmUgdGhlIGtleWJvYXJkLiBUaGlzXG4gKiBpcyBuZWVkZWQgaW4gZW52aXJvbm1lbnRzIHdoZXJlIHRoZSB3ZWJ2aWV3IGRvZXMgbm90XG4gKiByZXNpemUgd2hlbiB0aGUga2V5Ym9hcmQgb3BlbnMuXG4gKlxuICogRXhhbXBsZTogSWYgYW4gaW5wdXQgYXQgdGhlIGJvdHRvbSBvZiBpb24tY29udGVudCBpc1xuICogZm9jdXNlZCwgdGhlcmUgaXMgbm8gYWRkaXRpb25hbCBzY3JvbGxpbmcgc3BhY2UgYmVsb3dcbiAqIGl0LCBzbyB0aGUgaW5wdXQgY2Fubm90IGJlIHNjcm9sbGVkIGFib3ZlIHRoZSBrZXlib2FyZC5cbiAqIFNjcm9sbCBwYWRkaW5nIGZpeGVzIHRoaXMgYnkgYWRkaW5nIHBhZGRpbmcgZXF1YWwgdG8gdGhlXG4gKiBoZWlnaHQgb2YgdGhlIGtleWJvYXJkIHRvIHRoZSBib3R0b20gb2YgdGhlIGNvbnRlbnQuXG4gKlxuICogQ29tbW9uIGVudmlyb25tZW50cyB3aGVyZSB0aGlzIGlzIG5lZWRlZDpcbiAqIC0gTW9iaWxlIFNhZmFyaTogVGhlIGtleWJvYXJkIG92ZXJsYXlzIHRoZSBjb250ZW50XG4gKiAtIENhcGFjaXRvci9Db3Jkb3ZhIG9uIGlPUzogVGhlIGtleWJvYXJkIG92ZXJsYXlzIHRoZSBjb250ZW50XG4gKiB3aGVuIHRoZSBLZXlib2FyZFJlc2l6ZSBtb2RlIGlzIHNldCB0byAnbm9uZScuXG4gKi9cbmNvbnN0IHNldFNjcm9sbFBhZGRpbmcgPSAoY29udGVudEVsLCBwYWRkaW5nQW1vdW50LCBjbGVhckNhbGxiYWNrKSA9PiB7XG4gICAgY29uc3QgdGltZXIgPSBjb250ZW50RWxbUEFERElOR19USU1FUl9LRVldO1xuICAgIGlmICh0aW1lcikge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgIH1cbiAgICBpZiAocGFkZGluZ0Ftb3VudCA+IDApIHtcbiAgICAgICAgY29udGVudEVsLnN0eWxlLnNldFByb3BlcnR5KCctLWtleWJvYXJkLW9mZnNldCcsIGAke3BhZGRpbmdBbW91bnR9cHhgKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnRlbnRFbFtQQURESU5HX1RJTUVSX0tFWV0gPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGNvbnRlbnRFbC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS1rZXlib2FyZC1vZmZzZXQnLCAnMHB4Jyk7XG4gICAgICAgICAgICBpZiAoY2xlYXJDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGNsZWFyQ2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgMTIwKTtcbiAgICB9XG59O1xuLyoqXG4gKiBXaGVuIGFuIGlucHV0IGlzIGFib3V0IHRvIGJlIGZvY3VzZWQsXG4gKiBzZXQgYSB0aW1lb3V0IHRvIGNsZWFyIGFueSBzY3JvbGwgcGFkZGluZ1xuICogb24gdGhlIGNvbnRlbnQuIE5vdGU6IFRoZSBjbGVhcmluZ1xuICogaXMgZG9uZSBvbiBhIHRpbWVvdXQgc28gdGhhdCBpZiB1c2Vyc1xuICogYXJlIG1vdmluZyBmb2N1cyBmcm9tIG9uZSBpbnB1dCB0byB0aGUgbmV4dFxuICogdGhlbiByZS1hZGRpbmcgc2Nyb2xsIHBhZGRpbmcgdG8gdGhlIG5ld1xuICogaW5wdXQgd2l0aCBjYW5jZWwgdGhlIHRpbWVvdXQgdG8gY2xlYXIgdGhlXG4gKiBzY3JvbGwgcGFkZGluZy5cbiAqL1xuY29uc3Qgc2V0Q2xlYXJTY3JvbGxQYWRkaW5nTGlzdGVuZXIgPSAoaW5wdXRFbCwgY29udGVudEVsLCBkb25lQ2FsbGJhY2spID0+IHtcbiAgICBjb25zdCBjbGVhclNjcm9sbFBhZGRpbmcgPSAoKSA9PiB7XG4gICAgICAgIGlmIChjb250ZW50RWwpIHtcbiAgICAgICAgICAgIHNldFNjcm9sbFBhZGRpbmcoY29udGVudEVsLCAwLCBkb25lQ2FsbGJhY2spO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgY2xlYXJTY3JvbGxQYWRkaW5nLCB7IG9uY2U6IHRydWUgfSk7XG59O1xuXG5sZXQgY3VycmVudFBhZGRpbmcgPSAwO1xuY29uc3QgU0tJUF9TQ1JPTExfQVNTSVNUID0gJ2RhdGEtaW9uaWMtc2tpcC1zY3JvbGwtYXNzaXN0JztcbmNvbnN0IGVuYWJsZVNjcm9sbEFzc2lzdCA9IChjb21wb25lbnRFbCwgaW5wdXRFbCwgY29udGVudEVsLCBmb290ZXJFbCwga2V5Ym9hcmRIZWlnaHQsIGVuYWJsZVNjcm9sbFBhZGRpbmcsIGtleWJvYXJkUmVzaXplLCBkaXNhYmxlQ2xvbmVkSW5wdXQgPSBmYWxzZSkgPT4ge1xuICAgIC8qKlxuICAgICAqIFNjcm9sbCBwYWRkaW5nIHNob3VsZCBvbmx5IGJlIGFkZGVkIGlmOlxuICAgICAqIDEuIFRoZSBnbG9iYWwgc2Nyb2xsUGFkZGluZyBjb25maWcgb3B0aW9uXG4gICAgICogaXMgc2V0IHRvIHRydWUuXG4gICAgICogMi4gVGhlIG5hdGl2ZSBrZXlib2FyZCByZXNpemUgbW9kZSBpcyBlaXRoZXIgXCJub25lXCJcbiAgICAgKiAoa2V5Ym9hcmQgb3ZlcmxheXMgd2Vidmlldykgb3IgdW5kZWZpbmVkIChyZXNpemVcbiAgICAgKiBpbmZvcm1hdGlvbiB1bmF2YWlsYWJsZSlcbiAgICAgKiBSZXNpemUgaW5mbyBpcyBhdmFpbGFibGUgb24gQ2FwYWNpdG9yIDQrXG4gICAgICovXG4gICAgY29uc3QgYWRkU2Nyb2xsUGFkZGluZyA9IGVuYWJsZVNjcm9sbFBhZGRpbmcgJiYgKGtleWJvYXJkUmVzaXplID09PSB1bmRlZmluZWQgfHwga2V5Ym9hcmRSZXNpemUubW9kZSA9PT0gS2V5Ym9hcmRSZXNpemUuTm9uZSk7XG4gICAgLyoqXG4gICAgICogVGhpcyB0cmFja3Mgd2hldGhlciBvciBub3QgdGhlIGtleWJvYXJkIGhhcyBiZWVuXG4gICAgICogcHJlc2VudGVkIGZvciBhIHNpbmdsZSBmb2N1c2VkIHRleHQgZmllbGQuIE5vdGVcbiAgICAgKiB0aGF0IGl0IGRvZXMgbm90IHRyYWNrIGlmIHRoZSBrZXlib2FyZCBpcyBvcGVuXG4gICAgICogaW4gZ2VuZXJhbCBzdWNoIGFzIGlmIHRoZSBrZXlib2FyZCBpcyBvcGVuIGZvclxuICAgICAqIGEgZGlmZmVyZW50IGZvY3VzZWQgdGV4dCBmaWVsZC5cbiAgICAgKi9cbiAgICBsZXQgaGFzS2V5Ym9hcmRCZWVuUHJlc2VudGVkRm9yVGV4dEZpZWxkID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogV2hlbiBhZGRpbmcgc2Nyb2xsIHBhZGRpbmcgd2UgbmVlZCB0byBrbm93XG4gICAgICogaG93IG11Y2ggb2YgdGhlIHZpZXdwb3J0IHRoZSBrZXlib2FyZCBvYnNjdXJlcy5cbiAgICAgKiBXZSBkbyB0aGlzIGJ5IHN1YnRyYWN0aW5nIHRoZSBrZXlib2FyZCBoZWlnaHRcbiAgICAgKiBmcm9tIHRoZSBwbGF0Zm9ybSBoZWlnaHQuXG4gICAgICpcbiAgICAgKiBJZiB3ZSBjb21wdXRlIHRoaXMgdmFsdWUgd2hlbiBzd2l0Y2hpbmcgYmV0d2VlblxuICAgICAqIGlucHV0cyB0aGVuIHRoZSB3ZWJ2aWV3IG1heSBhbHJlYWR5IGJlIHJlc2l6ZWQuXG4gICAgICogQXQgdGhpcyBwb2ludCwgYHdpbi5pbm5lckhlaWdodGAgaGFzIGFscmVhZHkgYWNjb3VudGVkXG4gICAgICogZm9yIHRoZSBrZXlib2FyZCBtZWFuaW5nIHdlIHdvdWxkIHRoZW4gc3VidHJhY3RcbiAgICAgKiB0aGUga2V5Ym9hcmQgaGVpZ2h0IGFnYWluLiBUaGlzIHdpbGwgcmVzdWx0IGluIHRoZSBpbnB1dFxuICAgICAqIGJlaW5nIHNjcm9sbGVkIG1vcmUgdGhhbiBpdCBuZWVkcyB0by5cbiAgICAgKi9cbiAgICBjb25zdCBwbGF0Zm9ybUhlaWdodCA9IHdpbiAhPT0gdW5kZWZpbmVkID8gd2luLmlubmVySGVpZ2h0IDogMDtcbiAgICAvKipcbiAgICAgKiBTY3JvbGwgYXNzaXN0IGlzIHJ1biB3aGVuIGEgdGV4dCBmaWVsZFxuICAgICAqIGlzIGZvY3VzZWQuIEhvd2V2ZXIsIGl0IG1heSBuZWVkIHRvXG4gICAgICogcmUtcnVuIHdoZW4gdGhlIGtleWJvYXJkIHNpemUgY2hhbmdlc1xuICAgICAqIHN1Y2ggdGhhdCB0aGUgdGV4dCBmaWVsZCBpcyBub3cgaGlkZGVuXG4gICAgICogdW5kZXJuZWF0aCB0aGUga2V5Ym9hcmQuXG4gICAgICogVGhpcyBmdW5jdGlvbiByZS1ydW5zIHNjcm9sbCBhc3Npc3RcbiAgICAgKiB3aGVuIHRoYXQgaGFwcGVucy5cbiAgICAgKlxuICAgICAqIE9uZSBsaW1pdGF0aW9uIG9mIHRoaXMgaXMgb24gYSB3ZWIgYnJvd3NlclxuICAgICAqIHdoZXJlIG5hdGl2ZSBrZXlib2FyZCBBUElzIGRvIG5vdCBoYXZlIGNyb3NzLWJyb3dzZXJcbiAgICAgKiBzdXBwb3J0LiBgaW9uS2V5Ym9hcmREaWRTaG93YCByZWxpZXMgb24gdGhlIFZpc3VhbCBWaWV3cG9ydCBBUEkuXG4gICAgICogVGhpcyBtZWFucyB0aGF0IGlmIHRoZSBrZXlib2FyZCBjaGFuZ2VzIGJ1dCBkb2VzIG5vdCBjaGFuZ2VcbiAgICAgKiBnZW9tZXRyeSwgdGhlbiBzY3JvbGwgYXNzaXN0IHdpbGwgbm90IHJlLXJ1biBldmVuIGlmXG4gICAgICogdGhlIHVzZXIgaGFzIHNjcm9sbGVkIHRoZSB0ZXh0IGZpZWxkIHVuZGVyIHRoZSBrZXlib2FyZC5cbiAgICAgKiBUaGlzIGlzIG5vdCBhIHByb2JsZW0gd2hlbiBydW5uaW5nIGluIENvcmRvdmEvQ2FwYWNpdG9yXG4gICAgICogYmVjYXVzZSBgaW9uS2V5Ym9hcmREaWRTaG93YCB1c2VzIHRoZSBuYXRpdmUgZXZlbnRzXG4gICAgICogd2hpY2ggZmlyZSBldmVyeSB0aW1lIHRoZSBrZXlib2FyZCBjaGFuZ2VzLlxuICAgICAqL1xuICAgIGNvbnN0IGtleWJvYXJkU2hvdyA9IChldikgPT4ge1xuICAgICAgICAvKipcbiAgICAgICAgICogSWYgdGhlIGtleWJvYXJkIGhhcyBub3QgeWV0IGJlZW4gcHJlc2VudGVkXG4gICAgICAgICAqIGZvciB0aGlzIHRleHQgZmllbGQgdGhlbiB0aGUgdGV4dCBmaWVsZCBoYXMganVzdFxuICAgICAgICAgKiByZWNlaXZlZCBmb2N1cy4gSW4gdGhhdCBjYXNlLCB0aGUgZm9jdXNpbiBsaXN0ZW5lclxuICAgICAgICAgKiB3aWxsIHJ1biBzY3JvbGwgYXNzaXN0LlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGhhc0tleWJvYXJkQmVlblByZXNlbnRlZEZvclRleHRGaWVsZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGhhc0tleWJvYXJkQmVlblByZXNlbnRlZEZvclRleHRGaWVsZCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIE90aGVyd2lzZSwgdGhlIGtleWJvYXJkIGhhcyBhbHJlYWR5IGJlZW4gcHJlc2VudGVkXG4gICAgICAgICAqIGZvciB0aGUgZm9jdXNlZCB0ZXh0IGZpZWxkLlxuICAgICAgICAgKiBUaGlzIG1lYW5zIHRoYXQgdGhlIGtleWJvYXJkIGxpa2VseSBjaGFuZ2VkXG4gICAgICAgICAqIGdlb21ldHJ5LCBhbmQgd2UgbmVlZCB0byByZS1ydW4gc2Nyb2xsIGFzc2lzdC5cbiAgICAgICAgICogVGhpcyBjYW4gaGFwcGVuIHdoZW4gdGhlIHVzZXIgcm90YXRlcyB0aGVpciBkZXZpY2VcbiAgICAgICAgICogb3Igd2hlbiB0aGV5IHN3aXRjaCBrZXlib2FyZHMuXG4gICAgICAgICAqXG4gICAgICAgICAqIE1ha2Ugc3VyZSB3ZSBwYXNzIGluIHRoZSBjb21wdXRlZCBrZXlib2FyZCBoZWlnaHRcbiAgICAgICAgICogcmF0aGVyIHRoYW4gdGhlIGVzdGltYXRlZCBrZXlib2FyZCBoZWlnaHQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFNpbmNlIHRoZSBrZXlib2FyZCBpcyBhbHJlYWR5IG9wZW4gdGhlbiB3ZSBkbyBub3RcbiAgICAgICAgICogbmVlZCB0byB3YWl0IGZvciB0aGUgd2VidmlldyB0byByZXNpemUsIHNvIHdlIHBhc3NcbiAgICAgICAgICogXCJ3YWl0Rm9yUmVzaXplOiBmYWxzZVwiLlxuICAgICAgICAgKi9cbiAgICAgICAganNTZXRGb2N1cyhjb21wb25lbnRFbCwgaW5wdXRFbCwgY29udGVudEVsLCBmb290ZXJFbCwgZXYuZGV0YWlsLmtleWJvYXJkSGVpZ2h0LCBhZGRTY3JvbGxQYWRkaW5nLCBkaXNhYmxlQ2xvbmVkSW5wdXQsIHBsYXRmb3JtSGVpZ2h0LCBmYWxzZSk7XG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBSZXNldCB0aGUgaW50ZXJuYWwgc3RhdGUgd2hlbiB0aGUgdGV4dCBmaWVsZCBsb3NlcyBmb2N1cy5cbiAgICAgKi9cbiAgICBjb25zdCBmb2N1c091dCA9ICgpID0+IHtcbiAgICAgICAgaGFzS2V5Ym9hcmRCZWVuUHJlc2VudGVkRm9yVGV4dEZpZWxkID0gZmFsc2U7XG4gICAgICAgIHdpbiA9PT0gbnVsbCB8fCB3aW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdpbi5yZW1vdmVFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBrZXlib2FyZFNob3cpO1xuICAgICAgICBjb21wb25lbnRFbC5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGZvY3VzT3V0KTtcbiAgICB9O1xuICAgIC8qKlxuICAgICAqIFdoZW4gdGhlIGlucHV0IGlzIGFib3V0IHRvIHJlY2VpdmVcbiAgICAgKiBmb2N1cywgd2UgbmVlZCB0byBtb3ZlIGl0IHRvIHByZXZlbnRcbiAgICAgKiBtb2JpbGUgU2FmYXJpIGZyb20gYWRqdXN0aW5nIHRoZSB2aWV3cG9ydC5cbiAgICAgKi9cbiAgICBjb25zdCBmb2N1c0luID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAvKipcbiAgICAgICAgICogU2Nyb2xsIGFzc2lzdCBzaG91bGQgbm90IHJ1biBhZ2FpblxuICAgICAgICAgKiBvbiBpbnB1dHMgdGhhdCBoYXZlIGJlZW4gbWFudWFsbHlcbiAgICAgICAgICogZm9jdXNlZCBpbnNpZGUgb2YgdGhlIHNjcm9sbCBhc3Npc3RcbiAgICAgICAgICogaW1wbGVtZW50YXRpb24uXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoaW5wdXRFbC5oYXNBdHRyaWJ1dGUoU0tJUF9TQ1JPTExfQVNTSVNUKSkge1xuICAgICAgICAgICAgaW5wdXRFbC5yZW1vdmVBdHRyaWJ1dGUoU0tJUF9TQ1JPTExfQVNTSVNUKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBqc1NldEZvY3VzKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBjb250ZW50RWwsIGZvb3RlckVsLCBrZXlib2FyZEhlaWdodCwgYWRkU2Nyb2xsUGFkZGluZywgZGlzYWJsZUNsb25lZElucHV0LCBwbGF0Zm9ybUhlaWdodCk7XG4gICAgICAgIHdpbiA9PT0gbnVsbCB8fCB3aW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdpbi5hZGRFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBrZXlib2FyZFNob3cpO1xuICAgICAgICBjb21wb25lbnRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGZvY3VzT3V0KTtcbiAgICB9O1xuICAgIGNvbXBvbmVudEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBmb2N1c0luKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBjb21wb25lbnRFbC5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1c2luJywgZm9jdXNJbik7XG4gICAgICAgIHdpbiA9PT0gbnVsbCB8fCB3aW4gPT09IHZvaWQgMCA/IHZvaWQgMCA6IHdpbi5yZW1vdmVFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBrZXlib2FyZFNob3cpO1xuICAgICAgICBjb21wb25lbnRFbC5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1c291dCcsIGZvY3VzT3V0KTtcbiAgICB9O1xufTtcbi8qKlxuICogVXNlIHRoaXMgZnVuY3Rpb24gd2hlbiB5b3Ugd2FudCB0byBtYW51YWxseVxuICogZm9jdXMgYW4gaW5wdXQgYnV0IG5vdCBoYXZlIHNjcm9sbCBhc3Npc3QgcnVuIGFnYWluLlxuICovXG5jb25zdCBzZXRNYW51YWxGb2N1cyA9IChlbCkgPT4ge1xuICAgIHZhciBfYTtcbiAgICAvKipcbiAgICAgKiBJZiBlbGVtZW50IGlzIGFscmVhZHkgZm9jdXNlZCB0aGVuXG4gICAgICogYSBuZXcgZm9jdXNpbiBldmVudCB3aWxsIG5vdCBiZSBkaXNwYXRjaGVkXG4gICAgICogdG8gcmVtb3ZlIHRoZSBTS0lMX1NDUk9MTF9BU1NJU1QgYXR0cmlidXRlLlxuICAgICAqL1xuICAgIGlmIChkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBlbCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9wdGltaXphdGlvbiBmb3Igc2NlbmFyaW9zIHdoZXJlIHRoZSBjdXJyZW50bHkgZm9jdXNlZCBlbGVtZW50IGlzIGEgc2libGluZ1xuICAgICAqIG9mIHRoZSB0YXJnZXQgZWxlbWVudC4gSW4gc3VjaCBjYXNlcywgd2UgYXZvaWQgc2V0dGluZyBgU0tJUF9TQ1JPTExfQVNTSVNUYC5cbiAgICAgKlxuICAgICAqIFRoaXMgaXMgY3J1Y2lhbCBmb3IgYWNjZXNzaWJpbGl0eTogaW5wdXQgZWxlbWVudHMgY2FuIG5vdyBjb250YWluIGZvY3VzYWJsZVxuICAgICAqIHNpYmxpbmdzIChlLmcuLCBjbGVhciBidXR0b25zLCBzbG90dGVkIGVsZW1lbnRzKS4gSWYgd2UgZGlkbid0IHNraXAgc2V0dGluZ1xuICAgICAqIHRoZSBhdHRyaWJ1dGUgaGVyZSwgc2NyZWVuIHJlYWRlcnMgd291bGQgYmUgdW5hYmxlIHRvIG5hdmlnYXRlIHRvIGFuZCBpbnRlcmFjdFxuICAgICAqIHdpdGggdGhlc2Ugc2libGluZyBlbGVtZW50cy5cbiAgICAgKlxuICAgICAqIFdpdGhvdXQgdGhpcyBjaGVjaywgd2Ugd291bGQgbmVlZCB0byBjYWxsIGBldi5zdG9wUHJvcGFnYXRpb24oKWAgb24gdGhlXG4gICAgICogJ2ZvY3VzaW4nIGV2ZW50IG9mIGVhY2ggZm9jdXNhYmxlIHNpYmxpbmcgdG8gcHJldmVudCB0aGUgc2Nyb2xsIGFzc2lzdFxuICAgICAqIGxpc3RlbmVyIGZyb20gaW5jb3JyZWN0bHkgbW92aW5nIGZvY3VzIGJhY2sgdG8gdGhlIGlucHV0LiBUaGF0IGFwcHJvYWNoXG4gICAgICogd291bGQgYmUgbGVzcyBtYWludGFpbmFibGUgYW5kIG1vcmUgZXJyb3ItcHJvbmUuXG4gICAgICovXG4gICAgY29uc3QgaW5wdXRJZCA9IGVsLmdldEF0dHJpYnV0ZSgnaWQnKTtcbiAgICBjb25zdCBsYWJlbCA9IGVsLmNsb3Nlc3QoYGxhYmVsW2Zvcj1cIiR7aW5wdXRJZH1cIl1gKTtcbiAgICBjb25zdCBhY3RpdmVFbExhYmVsID0gKF9hID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNsb3Nlc3QoYGxhYmVsW2Zvcj1cIiR7aW5wdXRJZH1cIl1gKTtcbiAgICBpZiAobGFiZWwgIT09IG51bGwgJiYgbGFiZWwgPT09IGFjdGl2ZUVsTGFiZWwpIHtcbiAgICAgICAgLy8gSWYgdGhlIGxhYmVsIGlzIHRoZSBzYW1lIGFzIHRoZSBhY3RpdmUgZWxlbWVudCBsYWJlbCwgdGhlblxuICAgICAgICAvLyB3ZSBkb24ndCBuZWVkIHRvIHNldCB0aGUgYFNLSVBfU0NST0xMX0FTU0lTVGAgYW5kIHJlc2V0IGZvY3VzLlxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGVsLnNldEF0dHJpYnV0ZShTS0lQX1NDUk9MTF9BU1NJU1QsICd0cnVlJyk7XG4gICAgZWwuZm9jdXMoKTtcbn07XG5jb25zdCBqc1NldEZvY3VzID0gYXN5bmMgKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBjb250ZW50RWwsIGZvb3RlckVsLCBrZXlib2FyZEhlaWdodCwgZW5hYmxlU2Nyb2xsUGFkZGluZywgZGlzYWJsZUNsb25lZElucHV0ID0gZmFsc2UsIHBsYXRmb3JtSGVpZ2h0ID0gMCwgd2FpdEZvclJlc2l6ZSA9IHRydWUpID0+IHtcbiAgICBpZiAoIWNvbnRlbnRFbCAmJiAhZm9vdGVyRWwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBzY3JvbGxEYXRhID0gZ2V0U2Nyb2xsRGF0YShjb21wb25lbnRFbCwgKGNvbnRlbnRFbCB8fCBmb290ZXJFbCksIGtleWJvYXJkSGVpZ2h0LCBwbGF0Zm9ybUhlaWdodCk7XG4gICAgaWYgKGNvbnRlbnRFbCAmJiBNYXRoLmFicyhzY3JvbGxEYXRhLnNjcm9sbEFtb3VudCkgPCA0KSB7XG4gICAgICAgIC8vIHRoZSB0ZXh0IGlucHV0IGlzIGluIGEgc2FmZSBwb3NpdGlvbiB0aGF0IGRvZXNuJ3RcbiAgICAgICAgLy8gcmVxdWlyZSBpdCB0byBiZSBzY3JvbGxlZCBpbnRvIHZpZXcsIGp1c3Qgc2V0IGZvY3VzIG5vd1xuICAgICAgICBzZXRNYW51YWxGb2N1cyhpbnB1dEVsKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW4gdGhvdWdoIHRoZSBpbnB1dCBkb2VzIG5vdCBuZWVkXG4gICAgICAgICAqIHNjcm9sbCBhc3Npc3QsIHdlIHNob3VsZCBwcmVzZXJ2ZSB0aGVcbiAgICAgICAgICogdGhlIHNjcm9sbCBwYWRkaW5nIGFzIHVzZXJzIGNvdWxkIGJlIG1vdmluZ1xuICAgICAgICAgKiBmb2N1cyBmcm9tIGFuIGlucHV0IHRoYXQgbmVlZHMgc2Nyb2xsIHBhZGRpbmdcbiAgICAgICAgICogdG8gYW4gaW5wdXQgdGhhdCBkb2VzIG5vdCBuZWVkIHNjcm9sbCBwYWRkaW5nLlxuICAgICAgICAgKiBJZiB3ZSByZW1vdmUgdGhlIHNjcm9sbCBwYWRkaW5nIG5vdywgdXNlcnMgd2lsbFxuICAgICAgICAgKiBzZWUgdGhlIHBhZ2UganVtcC5cbiAgICAgICAgICovXG4gICAgICAgIGlmIChlbmFibGVTY3JvbGxQYWRkaW5nICYmIGNvbnRlbnRFbCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgc2V0U2Nyb2xsUGFkZGluZyhjb250ZW50RWwsIGN1cnJlbnRQYWRkaW5nKTtcbiAgICAgICAgICAgIHNldENsZWFyU2Nyb2xsUGFkZGluZ0xpc3RlbmVyKGlucHV0RWwsIGNvbnRlbnRFbCwgKCkgPT4gKGN1cnJlbnRQYWRkaW5nID0gMCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gdGVtcG9yYXJpbHkgbW92ZSB0aGUgZm9jdXMgdG8gdGhlIGZvY3VzIGhvbGRlciBzbyB0aGUgYnJvd3NlclxuICAgIC8vIGRvZXNuJ3QgZnJlYWsgb3V0IHdoaWxlIGl0J3MgdHJ5aW5nIHRvIGdldCB0aGUgaW5wdXQgaW4gcGxhY2VcbiAgICAvLyBhdCB0aGlzIHBvaW50IHRoZSBuYXRpdmUgdGV4dCBpbnB1dCBzdGlsbCBkb2VzIG5vdCBoYXZlIGZvY3VzXG4gICAgcmVsb2NhdGVJbnB1dChjb21wb25lbnRFbCwgaW5wdXRFbCwgdHJ1ZSwgc2Nyb2xsRGF0YS5pbnB1dFNhZmVZLCBkaXNhYmxlQ2xvbmVkSW5wdXQpO1xuICAgIHNldE1hbnVhbEZvY3VzKGlucHV0RWwpO1xuICAgIC8qKlxuICAgICAqIFJlbG9jYXRpbmcvRm9jdXNpbmcgaW5wdXQgY2F1c2VzIHRoZVxuICAgICAqIGNsaWNrIGV2ZW50IHRvIGJlIGNhbmNlbGxlZCwgc29cbiAgICAgKiBtYW51YWxseSBmaXJlIG9uZSBoZXJlLlxuICAgICAqL1xuICAgIHJhZigoKSA9PiBjb21wb25lbnRFbC5jbGljaygpKTtcbiAgICAvKipcbiAgICAgKiBJZiBlbmFibGVkLCB3ZSBjYW4gYWRkIHNjcm9sbCBwYWRkaW5nIHRvXG4gICAgICogdGhlIGJvdHRvbSBvZiB0aGUgY29udGVudCBzbyB0aGF0IHNjcm9sbCBhc3Npc3RcbiAgICAgKiBoYXMgZW5vdWdoIHJvb20gdG8gc2Nyb2xsIHRoZSBpbnB1dCBhYm92ZVxuICAgICAqIHRoZSBrZXlib2FyZC5cbiAgICAgKi9cbiAgICBpZiAoZW5hYmxlU2Nyb2xsUGFkZGluZyAmJiBjb250ZW50RWwpIHtcbiAgICAgICAgY3VycmVudFBhZGRpbmcgPSBzY3JvbGxEYXRhLnNjcm9sbFBhZGRpbmc7XG4gICAgICAgIHNldFNjcm9sbFBhZGRpbmcoY29udGVudEVsLCBjdXJyZW50UGFkZGluZyk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBsZXQgc2Nyb2xsQ29udGVudFRpbWVvdXQ7XG4gICAgICAgIGNvbnN0IHNjcm9sbENvbnRlbnQgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBjbGVhbiB1cCBsaXN0ZW5lcnMgYW5kIHRpbWVvdXRzXG4gICAgICAgICAgICBpZiAoc2Nyb2xsQ29udGVudFRpbWVvdXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChzY3JvbGxDb250ZW50VGltZW91dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignaW9uS2V5Ym9hcmREaWRTaG93JywgZG91YmxlS2V5Ym9hcmRFdmVudExpc3RlbmVyKTtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBzY3JvbGxDb250ZW50KTtcbiAgICAgICAgICAgIC8vIHNjcm9sbCB0aGUgaW5wdXQgaW50byBwbGFjZVxuICAgICAgICAgICAgaWYgKGNvbnRlbnRFbCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHNjcm9sbEJ5UG9pbnQoY29udGVudEVsLCAwLCBzY3JvbGxEYXRhLnNjcm9sbEFtb3VudCwgc2Nyb2xsRGF0YS5zY3JvbGxEdXJhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB0aGUgc2Nyb2xsIHZpZXcgaXMgaW4gdGhlIGNvcnJlY3QgcG9zaXRpb24gbm93XG4gICAgICAgICAgICAvLyBnaXZlIHRoZSBuYXRpdmUgdGV4dCBpbnB1dCBmb2N1c1xuICAgICAgICAgICAgcmVsb2NhdGVJbnB1dChjb21wb25lbnRFbCwgaW5wdXRFbCwgZmFsc2UsIHNjcm9sbERhdGEuaW5wdXRTYWZlWSk7XG4gICAgICAgICAgICAvLyBlbnN1cmUgdGhpcyBpcyB0aGUgZm9jdXNlZCBpbnB1dFxuICAgICAgICAgICAgc2V0TWFudWFsRm9jdXMoaW5wdXRFbCk7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFdoZW4gdGhlIGlucHV0IGlzIGFib3V0IHRvIGJlIGJsdXJyZWRcbiAgICAgICAgICAgICAqIHdlIHNob3VsZCBzZXQgYSB0aW1lb3V0IHRvIHJlbW92ZVxuICAgICAgICAgICAgICogYW55IHNjcm9sbCBwYWRkaW5nLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAoZW5hYmxlU2Nyb2xsUGFkZGluZykge1xuICAgICAgICAgICAgICAgIHNldENsZWFyU2Nyb2xsUGFkZGluZ0xpc3RlbmVyKGlucHV0RWwsIGNvbnRlbnRFbCwgKCkgPT4gKGN1cnJlbnRQYWRkaW5nID0gMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBkb3VibGVLZXlib2FyZEV2ZW50TGlzdGVuZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignaW9uS2V5Ym9hcmREaWRTaG93JywgZG91YmxlS2V5Ym9hcmRFdmVudExpc3RlbmVyKTtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBzY3JvbGxDb250ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGNvbnRlbnRFbCkge1xuICAgICAgICAgICAgY29uc3Qgc2Nyb2xsRWwgPSBhd2FpdCBnZXRTY3JvbGxFbGVtZW50KGNvbnRlbnRFbCk7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHNjcm9sbERhdGEgd2lsbCBvbmx5IGNvbnNpZGVyIHRoZSBhbW91bnQgd2UgbmVlZFxuICAgICAgICAgICAgICogdG8gc2Nyb2xsIGluIG9yZGVyIHRvIHByb3Blcmx5IGJyaW5nIHRoZSBpbnB1dFxuICAgICAgICAgICAgICogaW50byB2aWV3LiBJdCB3aWxsIG5vdCBjb25zaWRlciB0aGUgYW1vdW50XG4gICAgICAgICAgICAgKiB3ZSBjYW4gc2Nyb2xsIGluIHRoZSBjb250ZW50IGVsZW1lbnQuXG4gICAgICAgICAgICAgKiBBcyBhIHJlc3VsdCwgc2Nyb2xsRGF0YSBtYXkgcmVxdWVzdCBhIGdyZWF0ZXJcbiAgICAgICAgICAgICAqIHNjcm9sbCBwb3NpdGlvbiB0aGFuIGlzIGN1cnJlbnRseSBhdmFpbGFibGVcbiAgICAgICAgICAgICAqIGluIHRoZSBET00uIElmIHRoaXMgaXMgdGhlIGNhc2UsIHdlIG5lZWQgdG9cbiAgICAgICAgICAgICAqIHdhaXQgZm9yIHRoZSB3ZWJ2aWV3IHRvIHJlc2l6ZS90aGUga2V5Ym9hcmRcbiAgICAgICAgICAgICAqIHRvIHNob3cgaW4gb3JkZXIgZm9yIGFkZGl0aW9uYWwgc2Nyb2xsXG4gICAgICAgICAgICAgKiBiYW5kd2lkdGggdG8gYmVjb21lIGF2YWlsYWJsZS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29uc3QgdG90YWxTY3JvbGxBbW91bnQgPSBzY3JvbGxFbC5zY3JvbGxIZWlnaHQgLSBzY3JvbGxFbC5jbGllbnRIZWlnaHQ7XG4gICAgICAgICAgICBpZiAod2FpdEZvclJlc2l6ZSAmJiBzY3JvbGxEYXRhLnNjcm9sbEFtb3VudCA+IHRvdGFsU2Nyb2xsQW1vdW50IC0gc2Nyb2xsRWwuc2Nyb2xsVG9wKSB7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogT24gaU9TIGRldmljZXMsIHRoZSBzeXN0ZW0gd2lsbCBzaG93IGEgXCJQYXNzd29yZHNcIiBiYXIgYWJvdmUgdGhlIGtleWJvYXJkXG4gICAgICAgICAgICAgICAgICogYWZ0ZXIgdGhlIGluaXRpYWwga2V5Ym9hcmQgaXMgc2hvd24uIFRoaXMgcHJldmVudHMgdGhlIHdlYnZpZXcgZnJvbSByZXNpemluZ1xuICAgICAgICAgICAgICAgICAqIHVudGlsIHRoZSBcIlBhc3N3b3Jkc1wiIGJhciBpcyBzaG93biwgc28gd2UgbmVlZCB0byB3YWl0IGZvciB0aGF0IHRvIGhhcHBlbiBmaXJzdC5cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRFbC50eXBlID09PSAncGFzc3dvcmQnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCA1MHB4IHRvIGFjY291bnQgZm9yIHRoZSBcIlBhc3N3b3Jkc1wiIGJhclxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxEYXRhLnNjcm9sbEFtb3VudCArPSBTQ1JPTExfQU1PVU5UX1BBRERJTkc7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdpb25LZXlib2FyZERpZFNob3cnLCBkb3VibGVLZXlib2FyZEV2ZW50TGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2lvbktleWJvYXJkRGlkU2hvdycsIHNjcm9sbENvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBUaGlzIHNob3VsZCBvbmx5IGZpcmUgaW4gMiBpbnN0YW5jZXM6XG4gICAgICAgICAgICAgICAgICogMS4gVGhlIGFwcCBpcyB2ZXJ5IHNsb3cuXG4gICAgICAgICAgICAgICAgICogMi4gVGhlIGFwcCBpcyBydW5uaW5nIGluIGEgYnJvd3NlciBvbiBhbiBvbGQgT1NcbiAgICAgICAgICAgICAgICAgKiB0aGF0IGRvZXMgbm90IHN1cHBvcnQgSW9uaWMgS2V5Ym9hcmQgRXZlbnRzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgc2Nyb2xsQ29udGVudFRpbWVvdXQgPSBzZXRUaW1lb3V0KHNjcm9sbENvbnRlbnQsIDEwMDApO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzY3JvbGxDb250ZW50KCk7XG4gICAgfVxufTtcblxuY29uc3QgSU5QVVRfQkxVUlJJTkcgPSB0cnVlO1xuY29uc3Qgc3RhcnRJbnB1dFNoaW1zID0gYXN5bmMgKGNvbmZpZywgcGxhdGZvcm0pID0+IHtcbiAgICAvKipcbiAgICAgKiBJZiBkb2MgaXMgdW5kZWZpbmVkIHRoZW4gd2UgYXJlIGluIGFuIFNTUiBlbnZpcm9ubWVudFxuICAgICAqIHdoZXJlIGlucHV0IHNoaW1zIGRvIG5vdCBhcHBseS5cbiAgICAgKi9cbiAgICBpZiAoZG9jID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpc0lPUyA9IHBsYXRmb3JtID09PSAnaW9zJztcbiAgICBjb25zdCBpc0FuZHJvaWQgPSBwbGF0Zm9ybSA9PT0gJ2FuZHJvaWQnO1xuICAgIC8qKlxuICAgICAqIEhpZGUgQ2FyZXQgYW5kIElucHV0IEJsdXJyaW5nIGFyZSBuZWVkZWQgb24gaU9TLlxuICAgICAqIFNjcm9sbCBBc3Npc3QgYW5kIFNjcm9sbCBQYWRkaW5nIGFyZSBuZWVkZWQgb24gaU9TIGFuZCBBbmRyb2lkXG4gICAgICogd2l0aCBDaHJvbWUgd2ViIGJyb3dzZXIgKG5vdCBDaHJvbWUgd2VidmlldykuXG4gICAgICovXG4gICAgY29uc3Qga2V5Ym9hcmRIZWlnaHQgPSBjb25maWcuZ2V0TnVtYmVyKCdrZXlib2FyZEhlaWdodCcsIDI5MCk7XG4gICAgY29uc3Qgc2Nyb2xsQXNzaXN0ID0gY29uZmlnLmdldEJvb2xlYW4oJ3Njcm9sbEFzc2lzdCcsIHRydWUpO1xuICAgIGNvbnN0IGhpZGVDYXJldCA9IGNvbmZpZy5nZXRCb29sZWFuKCdoaWRlQ2FyZXRPblNjcm9sbCcsIGlzSU9TKTtcbiAgICAvKipcbiAgICAgKiBUaGUgdGVhbSBpcyBldmFsdWF0aW5nIGlmIGlucHV0Qmx1cnJpbmcgaXMgc3RpbGwgbmVlZGVkLiBBcyBhIHJlc3VsdFxuICAgICAqIHRoaXMgZmVhdHVyZSBpcyBkaXNhYmxlZCBieSBkZWZhdWx0IGFzIG9mIElvbmljIDguMC4gRGV2ZWxvcGVycyBhcmVcbiAgICAgKiBhYmxlIHRvIHJlLWVuYWJsZSBpdCB0ZW1wb3JhcmlseS4gVGhlIHRlYW0gbWF5IHJlbW92ZSB0aGlzIHV0aWxpdHlcbiAgICAgKiBpZiBpdCBpcyBkZXRlcm1pbmVkIHRoYXQgZG9pbmcgc28gd291bGQgbm90IGJyaW5nIGFueSBhZHZlcnNlIHNpZGUgZWZmZWN0cy5cbiAgICAgKiBUT0RPIEZXLTYwMTQgcmVtb3ZlIGlucHV0IGJsdXJyaW5nIHV0aWxpdHkgKGluY2x1ZGluZyBpbXBsZW1lbnRhdGlvbilcbiAgICAgKi9cbiAgICBjb25zdCBpbnB1dEJsdXJyaW5nID0gY29uZmlnLmdldEJvb2xlYW4oJ2lucHV0Qmx1cnJpbmcnLCBmYWxzZSk7XG4gICAgY29uc3Qgc2Nyb2xsUGFkZGluZyA9IGNvbmZpZy5nZXRCb29sZWFuKCdzY3JvbGxQYWRkaW5nJywgdHJ1ZSk7XG4gICAgY29uc3QgaW5wdXRzID0gQXJyYXkuZnJvbShkb2MucXVlcnlTZWxlY3RvckFsbCgnaW9uLWlucHV0LCBpb24tdGV4dGFyZWEnKSk7XG4gICAgY29uc3QgaGlkZUNhcmV0TWFwID0gbmV3IFdlYWtNYXAoKTtcbiAgICBjb25zdCBzY3JvbGxBc3Npc3RNYXAgPSBuZXcgV2Vha01hcCgpO1xuICAgIC8qKlxuICAgICAqIEdyYWIgdGhlIG5hdGl2ZSBrZXlib2FyZCByZXNpemUgY29uZmlndXJhdGlvblxuICAgICAqIGFuZCBwYXNzIGl0IHRvIHNjcm9sbCBhc3Npc3QuIFNjcm9sbCBhc3Npc3QgcmVxdWlyZXNcbiAgICAgKiB0aGF0IHdlIGFkanVzdCB0aGUgaW5wdXQgcmlnaHQgYmVmb3JlIHRoZSBpbnB1dFxuICAgICAqIGlzIGFib3V0IHRvIGJlIGZvY3VzZWQuIElmIHdlIGNhbGxlZCBgS2V5Ym9hcmQuZ2V0UmVzaXplTW9kZWBcbiAgICAgKiBvbiBmb2N1c2luIGluIHNjcm9sbCBhc3Npc3QsIHdlIGNvdWxkIHBvdGVudGlhbGx5IGFkanVzdCB0aGVcbiAgICAgKiBpbnB1dCB0b28gbGF0ZSBzaW5jZSB0aGlzIGNhbGwgaXMgYXN5bmMuXG4gICAgICovXG4gICAgY29uc3Qga2V5Ym9hcmRSZXNpemVNb2RlID0gYXdhaXQgS2V5Ym9hcmQuZ2V0UmVzaXplTW9kZSgpO1xuICAgIGNvbnN0IHJlZ2lzdGVySW5wdXQgPSBhc3luYyAoY29tcG9uZW50RWwpID0+IHtcbiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+IGNvbXBvbmVudE9uUmVhZHkoY29tcG9uZW50RWwsIHJlc29sdmUpKTtcbiAgICAgICAgY29uc3QgaW5wdXRSb290ID0gY29tcG9uZW50RWwuc2hhZG93Um9vdCB8fCBjb21wb25lbnRFbDtcbiAgICAgICAgY29uc3QgaW5wdXRFbCA9IGlucHV0Um9vdC5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpIHx8IGlucHV0Um9vdC5xdWVyeVNlbGVjdG9yKCd0ZXh0YXJlYScpO1xuICAgICAgICBjb25zdCBzY3JvbGxFbCA9IGZpbmRDbG9zZXN0SW9uQ29udGVudChjb21wb25lbnRFbCk7XG4gICAgICAgIGNvbnN0IGZvb3RlckVsID0gIXNjcm9sbEVsID8gY29tcG9uZW50RWwuY2xvc2VzdCgnaW9uLWZvb3RlcicpIDogbnVsbDtcbiAgICAgICAgaWYgKCFpbnB1dEVsKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEhc2Nyb2xsRWwgJiYgaGlkZUNhcmV0ICYmICFoaWRlQ2FyZXRNYXAuaGFzKGNvbXBvbmVudEVsKSkge1xuICAgICAgICAgICAgY29uc3Qgcm1GbiA9IGVuYWJsZUhpZGVDYXJldE9uU2Nyb2xsKGNvbXBvbmVudEVsLCBpbnB1dEVsLCBzY3JvbGxFbCk7XG4gICAgICAgICAgICBoaWRlQ2FyZXRNYXAuc2V0KGNvbXBvbmVudEVsLCBybUZuKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogZGF0ZS9kYXRldGltZS1sb2NhbGUgaW5wdXRzIG9uIG1vYmlsZSBkZXZpY2VzIHNob3cgZGF0ZSBwaWNrZXJcbiAgICAgICAgICogb3ZlcmxheXMgaW5zdGVhZCBvZiBrZXlib2FyZHMuIEFzIGEgcmVzdWx0LCBzY3JvbGwgYXNzaXN0IGlzXG4gICAgICAgICAqIG5vdCBuZWVkZWQuIFRoaXMgYWxzbyB3b3JrcyBhcm91bmQgYSBidWcgaW4gaU9TIDwxNiB3aGVyZVxuICAgICAgICAgKiBzY3JvbGwgYXNzaXN0IGNhdXNlcyB0aGUgYnJvd3NlciB0byBsb2NrIHVwLiBTZWUgRlctMTk5Ny5cbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0IGlzRGF0ZUlucHV0ID0gaW5wdXRFbC50eXBlID09PSAnZGF0ZScgfHwgaW5wdXRFbC50eXBlID09PSAnZGF0ZXRpbWUtbG9jYWwnO1xuICAgICAgICBpZiAoIWlzRGF0ZUlucHV0ICYmXG4gICAgICAgICAgICAoISFzY3JvbGxFbCB8fCAhIWZvb3RlckVsKSAmJlxuICAgICAgICAgICAgc2Nyb2xsQXNzaXN0ICYmXG4gICAgICAgICAgICAhc2Nyb2xsQXNzaXN0TWFwLmhhcyhjb21wb25lbnRFbCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHJtRm4gPSBlbmFibGVTY3JvbGxBc3Npc3QoY29tcG9uZW50RWwsIGlucHV0RWwsIHNjcm9sbEVsLCBmb290ZXJFbCwga2V5Ym9hcmRIZWlnaHQsIHNjcm9sbFBhZGRpbmcsIGtleWJvYXJkUmVzaXplTW9kZSwgaXNBbmRyb2lkKTtcbiAgICAgICAgICAgIHNjcm9sbEFzc2lzdE1hcC5zZXQoY29tcG9uZW50RWwsIHJtRm4pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCB1bnJlZ2lzdGVySW5wdXQgPSAoY29tcG9uZW50RWwpID0+IHtcbiAgICAgICAgaWYgKGhpZGVDYXJldCkge1xuICAgICAgICAgICAgY29uc3QgZm4gPSBoaWRlQ2FyZXRNYXAuZ2V0KGNvbXBvbmVudEVsKTtcbiAgICAgICAgICAgIGlmIChmbikge1xuICAgICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoaWRlQ2FyZXRNYXAuZGVsZXRlKGNvbXBvbmVudEVsKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2Nyb2xsQXNzaXN0KSB7XG4gICAgICAgICAgICBjb25zdCBmbiA9IHNjcm9sbEFzc2lzdE1hcC5nZXQoY29tcG9uZW50RWwpO1xuICAgICAgICAgICAgaWYgKGZuKSB7XG4gICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNjcm9sbEFzc2lzdE1hcC5kZWxldGUoY29tcG9uZW50RWwpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBpZiAoaW5wdXRCbHVycmluZyAmJiBJTlBVVF9CTFVSUklORykge1xuICAgICAgICBlbmFibGVJbnB1dEJsdXJyaW5nKCk7XG4gICAgfVxuICAgIC8vIElucHV0IG1pZ2h0IGJlIGFscmVhZHkgbG9hZGVkIGluIHRoZSBET00gYmVmb3JlIGlvbi1kZXZpY2UtaGFja3MgZGlkLlxuICAgIC8vIEF0IHRoaXMgcG9pbnQgd2UgbmVlZCB0byBsb29rIGZvciBhbGwgb2YgdGhlIGlucHV0cyBub3QgcmVnaXN0ZXJlZCB5ZXRcbiAgICAvLyBhbmQgcmVnaXN0ZXIgdGhlbS5cbiAgICBmb3IgKGNvbnN0IGlucHV0IG9mIGlucHV0cykge1xuICAgICAgICByZWdpc3RlcklucHV0KGlucHV0KTtcbiAgICB9XG4gICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ2lvbklucHV0RGlkTG9hZCcsIChldikgPT4ge1xuICAgICAgICByZWdpc3RlcklucHV0KGV2LmRldGFpbCk7XG4gICAgfSk7XG4gICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoJ2lvbklucHV0RGlkVW5sb2FkJywgKGV2KSA9PiB7XG4gICAgICAgIHVucmVnaXN0ZXJJbnB1dChldi5kZXRhaWwpO1xuICAgIH0pO1xufTtcblxuZXhwb3J0IHsgc3RhcnRJbnB1dFNoaW1zIH07XG4iXSwibmFtZXMiOlsiY2xvbmVNYXAiLCJyZWxvY2F0ZUlucHV0IiwiY29tcG9uZW50RWwiLCJpbnB1dEVsIiwic2hvdWxkUmVsb2NhdGUiLCJpbnB1dFJlbGF0aXZlWSIsImRpc2FibGVkQ2xvbmVkSW5wdXQiLCJhZGRDbG9uZSIsInJlbW92ZUNsb25lIiwiaXNGb2N1c2VkIiwiaW5wdXQiLCJwYXJlbnRFbCIsImNsb25lZEVsIiwidHgiLCJjbG9uZSIsIlNDUk9MTF9BTU9VTlRfUEFERElORyIsImVuYWJsZUhpZGVDYXJldE9uU2Nyb2xsIiwic2Nyb2xsRWwiLCJzY3JvbGxIaWRlQ2FyZXQiLCJzaG91bGRIaWRlQ2FyZXQiLCJvbkJsdXIiLCJoaWRlQ2FyZXQiLCJzaG93Q2FyZXQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlNLSVBfU0VMRUNUT1IiLCJlbmFibGVJbnB1dEJsdXJyaW5nIiwiZm9jdXNlZCIsImRpZFNjcm9sbCIsImRvYyIsIm9uU2Nyb2xsIiwib25Gb2N1c2luIiwib25Ub3VjaGVuZCIsImV2IiwiYWN0aXZlIiwidGFwcGVkIiwiU0NST0xMX0FTU0lTVF9TUEVFRCIsImdldFNjcm9sbERhdGEiLCJjb250ZW50RWwiLCJrZXlib2FyZEhlaWdodCIsInBsYXRmb3JtSGVpZ2h0IiwiX2EiLCJpdGVtRWwiLCJjYWxjU2Nyb2xsRGF0YSIsImlucHV0UmVjdCIsImNvbnRlbnRSZWN0IiwiaW5wdXRUb3AiLCJpbnB1dEJvdHRvbSIsInZpc2libGVBcmVhVG9wIiwidmlzaWJsZUFyZWFCb3R0b20iLCJzYWZlQXJlYVRvcCIsImRpc3RhbmNlVG9Cb3R0b20iLCJkaXN0YW5jZVRvVG9wIiwiZGVzaXJlZFNjcm9sbEFtb3VudCIsInNjcm9sbEFtb3VudCIsImR1cmF0aW9uIiwic2Nyb2xsRHVyYXRpb24iLCJQQURESU5HX1RJTUVSX0tFWSIsInNldFNjcm9sbFBhZGRpbmciLCJwYWRkaW5nQW1vdW50IiwiY2xlYXJDYWxsYmFjayIsInRpbWVyIiwic2V0Q2xlYXJTY3JvbGxQYWRkaW5nTGlzdGVuZXIiLCJkb25lQ2FsbGJhY2siLCJjbGVhclNjcm9sbFBhZGRpbmciLCJjdXJyZW50UGFkZGluZyIsIlNLSVBfU0NST0xMX0FTU0lTVCIsImVuYWJsZVNjcm9sbEFzc2lzdCIsImZvb3RlckVsIiwiZW5hYmxlU2Nyb2xsUGFkZGluZyIsImtleWJvYXJkUmVzaXplIiwiZGlzYWJsZUNsb25lZElucHV0IiwiYWRkU2Nyb2xsUGFkZGluZyIsIktleWJvYXJkUmVzaXplIiwiaGFzS2V5Ym9hcmRCZWVuUHJlc2VudGVkRm9yVGV4dEZpZWxkIiwid2luIiwia2V5Ym9hcmRTaG93IiwianNTZXRGb2N1cyIsImZvY3VzT3V0IiwiZm9jdXNJbiIsInNldE1hbnVhbEZvY3VzIiwiZWwiLCJpbnB1dElkIiwibGFiZWwiLCJhY3RpdmVFbExhYmVsIiwid2FpdEZvclJlc2l6ZSIsInNjcm9sbERhdGEiLCJyYWYiLCJzY3JvbGxDb250ZW50VGltZW91dCIsInNjcm9sbENvbnRlbnQiLCJkb3VibGVLZXlib2FyZEV2ZW50TGlzdGVuZXIiLCJzY3JvbGxCeVBvaW50IiwiZ2V0U2Nyb2xsRWxlbWVudCIsInRvdGFsU2Nyb2xsQW1vdW50IiwiSU5QVVRfQkxVUlJJTkciLCJzdGFydElucHV0U2hpbXMiLCJjb25maWciLCJwbGF0Zm9ybSIsImlzSU9TIiwiaXNBbmRyb2lkIiwic2Nyb2xsQXNzaXN0IiwiaW5wdXRCbHVycmluZyIsInNjcm9sbFBhZGRpbmciLCJpbnB1dHMiLCJoaWRlQ2FyZXRNYXAiLCJzY3JvbGxBc3Npc3RNYXAiLCJrZXlib2FyZFJlc2l6ZU1vZGUiLCJLZXlib2FyZCIsInJlZ2lzdGVySW5wdXQiLCJyZXNvbHZlIiwiY29tcG9uZW50T25SZWFkeSIsImlucHV0Um9vdCIsImZpbmRDbG9zZXN0SW9uQ29udGVudCIsInJtRm4iLCJ1bnJlZ2lzdGVySW5wdXQiLCJmbiJdLCJtYXBwaW5ncyI6IjhHQVFBLE1BQU1BLEVBQVcsSUFBSSxRQUNmQyxFQUFnQixDQUFDQyxFQUFhQyxFQUFTQyxFQUFnQkMsRUFBaUIsRUFBR0MsRUFBc0IsS0FBVSxDQUN6R04sRUFBUyxJQUFJRSxDQUFXLElBQU1FLElBRzlCQSxFQUNBRyxFQUFTTCxFQUFhQyxFQUFTRSxFQUFnQkMsQ0FBbUIsRUFHbEVFLEVBQVlOLEVBQWFDLENBQU8sRUFFeEMsRUFDTU0sRUFBYUMsR0FVUkEsSUFBVUEsRUFBTSxZQUFXLEVBQUcsY0FFbkNILEVBQVcsQ0FBQ0wsRUFBYUMsRUFBU0UsRUFBZ0JDLEVBQXNCLEtBQVUsQ0FVcEYsTUFBTUssRUFBV1IsRUFBUSxXQUVuQlMsRUFBV1QsRUFBUSxVQUFVLEVBQUssRUFDeENTLEVBQVMsVUFBVSxJQUFJLGNBQWMsRUFDckNBLEVBQVMsU0FBVyxHQWFoQk4sSUFDQU0sRUFBUyxTQUFXLElBRXhCRCxFQUFTLFlBQVlDLENBQVEsRUFDN0JaLEVBQVMsSUFBSUUsRUFBYVUsQ0FBUSxFQUVsQyxN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LHlCQUF5QixDQUFDLEVBQ25FMkUsRUFBZSxJQUFJLFFBQ25CQyxFQUFrQixJQUFJLFFBU3RCQyxFQUFxQixNQUFNQyxFQUFTLGNBQWEsRUFDakRDLEVBQWdCLE1BQU8xRyxHQUFnQixDQUN6QyxNQUFNLElBQUksUUFBUzJHLEdBQVlDLEVBQWlCNUcsRUFBYTJHLENBQU8sQ0FBQyxFQUNyRSxNQUFNRSxFQUFZN0csRUFBWSxZQUFjQSxFQUN0Q0MsRUFBVTRHLEVBQVUsY0FBYyxPQUFPLEdBQUtBLEVBQVUsY0FBYyxVQUFVLEVBQ2hGOUYsRUFBVytGLEVBQXNCOUcsQ0FBVyxFQUM1Q2tFLEVBQVluRCxFQUErQyxLQUFwQ2YsRUFBWSxRQUFRLFlBQVksRUFDN0QsR0FBSSxDQUFDQyxFQUNELE9BRUosR0FBTWMsR0FBWUksR0FBYSxDQUFDbUYsRUFBYSxJQUFJdEcsQ0FBVyxFQUFHLENBQzNELE1BQU0rRyxFQUFPakcsRUFBd0JkLEVBQWFDLEVBQVNjLENBQVEsRUFDbkV1RixFQUFhLElBQUl0RyxFQUFhK0csQ0FBSSxDQUN0QyxDQVFBLEdBQUksRUFEZ0I5RyxFQUFRLE9BQVMsUUFBVUEsRUFBUSxPQUFTLG9CQUV6RGMsR0FBY21ELElBQ2pCZ0MsR0FDQSxDQUFDSyxFQUFnQixJQUFJdkcsQ0FBVyxFQUFHLENBQ25DLE1BQU0rRyxFQUFPOUMsRUFBbUJqRSxFQUFhQyxFQUFTYyxFQUFVbUQsRUFBVTdCLEVBQWdCK0QsRUFBZUksRUFBb0JQLENBQVMsRUFDdElNLEVBQWdCLElBQUl2RyxFQUFhK0csQ0FBSSxDQUN6QyxDQUNKLEVBQ01DLEVBQW1CaEgsR0FBZ0IsQ0FDckMsR0FBSW1CLEVBQVcsQ0FDWCxNQUFNOEYsRUFBS1gsRUFBYSxJQUFJdEcsQ0FBVyxFQUNuQ2lILEdBQ0FBLEVBQUUsRUFFTlgsRUFBYSxPQUFPdEcsQ0FBVyxDQUNuQyxDQUNBLEdBQUlrRyxFQUFjLENBQ2QsTUFBTWUsRUFBS1YsRUFBZ0IsSUFBSXZHLENBQVcsRUFDdENpSCxHQUNBQSxFQUFFLEVBRU5WLEVBQWdCLE9BQU92RyxDQUFXLENBQ3RDLENBQ0osRUFDSW1HLEdBQWlCUCxHQUNqQnBFLEVBQW1CLEVBS3ZCLFVBQVdoQixLQUFTNkYsRUFDaEJLLEVBQWNsRyxDQUFLLEVBRXZCbUIsRUFBSSxpQkFBaUIsa0JBQW9CSSxHQUFPLENBQzVDMkUsRUFBYzNFLEVBQUcsTUFBTSxDQUMzQixDQUFDLEVBQ0RKLEVBQUksaUJBQWlCLG9CQUFzQkksR0FBTyxDQUM5Q2lGLEVBQWdCakYsRUFBRyxNQUFNLENBQzdCLENBQUMsQ0FDTCIsInhfZ29vZ2xlX2lnbm9yZUxpc3QiOlswXX0=
